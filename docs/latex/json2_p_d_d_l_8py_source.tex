\doxysection{json2\+PDDL.\+py}
\hypertarget{json2_p_d_d_l_8py_source}{}\label{json2_p_d_d_l_8py_source}\index{toolkit/json2PDDL.py@{toolkit/json2PDDL.py}}
\mbox{\hyperlink{json2_p_d_d_l_8py}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00001}\mbox{\hyperlink{namespacetoolkit_1_1json2_p_d_d_l}{00001}}\ \textcolor{comment}{\#!/usr/bin/env\ python}}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00003}00003\ \textcolor{keyword}{import}\ sys}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00004}00004\ \textcolor{keyword}{import}\ json}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00005}00005\ \textcolor{keyword}{import}\ argparse}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00006}00006\ \textcolor{keyword}{import}\ os}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00008}00008\ \textcolor{keyword}{from}\ beluga\_lib.beluga\_problem\ \textcolor{keyword}{import}\ BelugaProblem}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00009}00009\ \textcolor{keyword}{from}\ encoder.pddl\_encoding\ \textcolor{keyword}{import}\ DomainEncoding}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00010}00010\ \textcolor{keyword}{from}\ encoder.pddl\_encoding\ \textcolor{keyword}{import}\ encode}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00011}00011\ \textcolor{keyword}{from}\ beluga\_lib.beluga\_problem\ \textcolor{keyword}{import}\ BelugaProblemDecoder}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00012}00012\ \textcolor{keyword}{from}\ encoder.pddl\_encoding.variant\ \textcolor{keyword}{import}\ Variant}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00015}\mbox{\hyperlink{namespacetoolkit_1_1json2_p_d_d_l_ab47beadcfdd96ac3c90603b19d0a1a70}{00015}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacetoolkit_1_1json2_p_d_d_l_ab47beadcfdd96ac3c90603b19d0a1a70}{generate\_domain}}(variant:\ Variant,\ problem\_out,\ inst=\textcolor{keywordtype}{None},\ domain\_name=\textcolor{stringliteral}{"{}domain.pddl"{}}):}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00016}00016\ \ \ \ \ domain\_encoding\ =\ \mbox{\hyperlink{classtoolkit_1_1encoder_1_1pddl__encoding_1_1beluga__pddl__domain__encoding_1_1_domain_encoding}{DomainEncoding}}(variant,\ inst)}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00017}00017\ \ \ \ \ name\ =\ \textcolor{stringliteral}{'beluga'}}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00018}00018\ \ \ \ \ \textcolor{keywordflow}{if}\ problem\_out:}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00019}00019\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ open(os.path.join(problem\_out,\ domain\_name),\ \textcolor{stringliteral}{'w'})\ \textcolor{keyword}{as}\ out\_file:}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00020}00020\ \ \ \ \ \ \ \ \ \ \ \ \ out\_file.write(domain\_encoding.domain.to\_pddl(name))}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00021}00021\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00022}00022\ \ \ \ \ \ \ \ \ print(domain\_encoding.domain.to\_pddl(name))}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00024}00024\ \ \ \ \ \textcolor{keywordflow}{return}\ domain\_encoding}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00025}00025\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00027}\mbox{\hyperlink{namespacetoolkit_1_1json2_p_d_d_l_acabcb78ecd730fc2a31249b9154ee035}{00027}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacetoolkit_1_1json2_p_d_d_l_acabcb78ecd730fc2a31249b9154ee035}{generate\_problem}}(\ variant:\ Variant,\ inst:\ BelugaProblem,\ problem\_name:\ str,\ domain\_encoding:\ DomainEncoding,\ problem\_out):}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00028}00028\ \ \ \ \ pddl\_problem\ =\ encode(problem\_name,\ inst,\ domain\_encoding.domain,\ variant)}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00029}00029\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00030}00030\ \ \ \ \ name\ =\ \textcolor{stringliteral}{"{}beluga-\/"{}}\ +\ problem\_name}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00031}00031\ \ \ \ \ name\ =\ name.replace(\textcolor{stringliteral}{"{}."{}},\textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00032}00032\ \ \ \ \ \textcolor{keywordflow}{if}\ problem\_out:}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00033}00033\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ open(os.path.join(problem\_out,\ problem\_name\ +\ \textcolor{stringliteral}{"{}.pddl"{}}),\ \textcolor{stringliteral}{'w'})\ \textcolor{keyword}{as}\ out\_file:}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00034}00034\ \ \ \ \ \ \ \ \ \ \ \ \ out\_file.write(pddl\_problem.to\_pddl(name))}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00035}00035\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00036}00036\ \ \ \ \ \ \ \ \ print(pddl\_problem.to\_pddl(name))}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00037}00037\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00038}00038\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00039}\mbox{\hyperlink{namespacetoolkit_1_1json2_p_d_d_l_af83e94c997532e5d72a8682e01a70e67}{00039}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacetoolkit_1_1json2_p_d_d_l_af83e94c997532e5d72a8682e01a70e67}{main}}(instance\_file,\ variant:\ Variant,\ problem\_out):}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00041}00041\ \ \ \ \ \textcolor{keyword}{with}\ open(instance\_file,\ \textcolor{stringliteral}{'r'})\ \textcolor{keyword}{as}\ fp:}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00042}00042\ \ \ \ \ \ \ \ \ inst\ =\ json.load(fp,\ cls=BelugaProblemDecoder)}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00044}00044\ \ \ \ \ problem\_name\ =\ os.path.basename(instance\_file).replace(\textcolor{stringliteral}{"{}.json"{}},\textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00045}00045\ \ \ \ \ instance\_name\ =\ problem\_name.replace(\textcolor{stringliteral}{'problem\_'},\ \textcolor{stringliteral}{''})}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00046}00046\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00047}00047\ \ \ \ \ \textcolor{keywordflow}{if}\ variant.probabilistic:}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ domain\_encoding\ =\ \mbox{\hyperlink{namespacetoolkit_1_1json2_p_d_d_l_ab47beadcfdd96ac3c90603b19d0a1a70}{generate\_domain}}(variant,\ problem\_out,\ inst,\ \textcolor{stringliteral}{'domain\_'}\ +\ problem\_name\ +\ \textcolor{stringliteral}{"{}.pddl"{}})}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00049}00049\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ domain\_encoding\ =\ \mbox{\hyperlink{namespacetoolkit_1_1json2_p_d_d_l_ab47beadcfdd96ac3c90603b19d0a1a70}{generate\_domain}}(variant,\ problem\_out)}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00051}00051\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00052}00052\ \ \ \ \ \mbox{\hyperlink{namespacetoolkit_1_1json2_p_d_d_l_acabcb78ecd730fc2a31249b9154ee035}{generate\_problem}}(variant,\ inst,\ problem\_name,\ domain\_encoding,\ problem\_out)}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00053}00053\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00054}00054\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00055}00055\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00056}00056\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00057}00057\ \textcolor{keywordflow}{if}\ \_\_name\_\_\ ==\ \textcolor{stringliteral}{"{}\_\_main\_\_"{}}:}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00058}\mbox{\hyperlink{namespacetoolkit_1_1json2_p_d_d_l_a45123d0d36c3d9e27b8873f09a1bd458}{00058}}\ \ \ \ \ parser\ =\ argparse.ArgumentParser(description=\textcolor{stringliteral}{'Description\ of\ your\ program'})}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00059}\mbox{\hyperlink{namespacetoolkit_1_1json2_p_d_d_l_a39ff7a59ffe61079ec9c48dda549bb5d}{00059}}\ \ \ \ \ parser.add\_argument(\textcolor{stringliteral}{'-\/o'},\ \textcolor{stringliteral}{'-\/-\/problem-\/out'},\ dest=\textcolor{stringliteral}{"{}problem\_out"{}},\ type=str,\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00060}\mbox{\hyperlink{namespacetoolkit_1_1json2_p_d_d_l_a5df4077f44cbd9097553522cbeb3618e}{00060}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ required=\textcolor{keyword}{False},\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00061}\mbox{\hyperlink{namespacetoolkit_1_1json2_p_d_d_l_a553be6334b14e344c80bc6b988a07c54}{00061}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ help=\textcolor{stringliteral}{'output\ folder\ for\ the\ problem/domain,\ the\ problem\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00062}00062\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ keeps\ its\ name,\ if\ no\ folder\ is\ specified\ the\ pddl\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00063}00063\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ encoding\ is\ printed\ onto\ stdout'})}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00064}00064\ \ \ \ \ parser.add\_argument(\textcolor{stringliteral}{'-\/i'},\ \textcolor{stringliteral}{'-\/-\/instance'},\ help=\textcolor{stringliteral}{'JSON\ file\ of\ instance\ to\ encode'},\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00065}00065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ required=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00066}00066\ \ \ \ \ parser.add\_argument(\textcolor{stringliteral}{'-\/n'},\ dest=\textcolor{stringliteral}{"{}numeric"{}},\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ help=\textcolor{stringliteral}{"{}numeric\ encoding,\ otherwise\ classic\ encoding"{}},\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00068}\mbox{\hyperlink{namespacetoolkit_1_1json2_p_d_d_l_ab8605dec492289701c91e4255950a9b8}{00068}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ action=\textcolor{stringliteral}{'store\_true'})}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00069}00069\ \ \ \ \ parser.add\_argument(\textcolor{stringliteral}{'-\/p'},\ dest=\textcolor{stringliteral}{"{}probabilistic"{}},\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00070}00070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ help=\textcolor{stringliteral}{"{}probabilistic\ encoding"{}},\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00071}00071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ action=\textcolor{stringliteral}{'store\_true'})}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00072}00072\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00073}00073\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00074}\mbox{\hyperlink{namespacetoolkit_1_1json2_p_d_d_l_a2d24ba167e5b07fe003a8f63c53df804}{00074}}\ \ \ \ \ args\ =\ parser.parse\_args()}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00075}00075\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00076}\mbox{\hyperlink{namespacetoolkit_1_1json2_p_d_d_l_a91625058be71710ff7358de8cdadc686}{00076}}\ \ \ \ \ instance\_file\ =\ args.instance}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00077}00077\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00078}\mbox{\hyperlink{namespacetoolkit_1_1json2_p_d_d_l_a0129d65244a1ecc99adb1b8ffacbc9ce}{00078}}\ \ \ \ \ problem\_out\ =\ args.problem\_out}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00079}\mbox{\hyperlink{namespacetoolkit_1_1json2_p_d_d_l_a1047cc7c490317d6e864b89c93c17ae0}{00079}}\ \ \ \ \ variant\ =\ \mbox{\hyperlink{classtoolkit_1_1encoder_1_1pddl__encoding_1_1variant_1_1_variant}{Variant}}()}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00080}\mbox{\hyperlink{namespacetoolkit_1_1json2_p_d_d_l_abb5083c281825dd849ab5e92553d20e4}{00080}}\ \ \ \ \ variant.classic\ =\ \textcolor{keywordflow}{not}\ args.numeric}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00081}\mbox{\hyperlink{namespacetoolkit_1_1json2_p_d_d_l_a8e3a09a121936c6f483386c9f9ef5e14}{00081}}\ \ \ \ \ variant.probabilistic\ =\ args.probabilistic}
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{json2_p_d_d_l_8py_source_l00083}00083\ \ \ \ \ main(instance\_file,\ variant,\ problem\_out)}

\end{DoxyCode}
