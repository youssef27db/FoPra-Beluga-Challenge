\doxysection{rl.\+mcts.\+mcts.\+MCTS Class Reference}
\hypertarget{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s}{}\label{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s}\index{rl.mcts.mcts.MCTS@{rl.mcts.mcts.MCTS}}


Monte Carlo Tree Search algorithm implementation.  


\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_af8413689d831e059f7e36002b0375e0b}{\+\_\+\+\_\+init\+\_\+\+\_\+}} (self, \mbox{\hyperlink{classrl_1_1mcts_1_1mcts__node_1_1_m_c_t_s_node}{MCTSNode}} \mbox{\hyperlink{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_a11142d8d66dba17479436e590192fb90}{root}}, int \mbox{\hyperlink{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_aab310caec54328f75daa9e0a82fa35c7}{depth}}=5, int \mbox{\hyperlink{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_a8f4bd2ea226660619b54bd7a3bed820f}{n\+\_\+simulations}}=300, bool \mbox{\hyperlink{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_adbbff374479f0397a831fbbd3059dec8}{debug}}=False)
\begin{DoxyCompactList}\small\item\em Initialize \doxylink{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s}{MCTS} algorithm. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_a156ee61d7a35a8cab7ec32494dea1b2a}{search}} (self)
\begin{DoxyCompactList}\small\item\em Run the \doxylink{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s}{MCTS} search algorithm. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_af0c0d8b6cb7e0d0bc83d009fa6a6ebc3}{select}} (self, node)
\begin{DoxyCompactList}\small\item\em Traverse the tree until we find a not fully expanded node or terminal node. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_abf0f1615b5957012620acadb53e31562}{rollout}} (self, node)
\begin{DoxyCompactList}\small\item\em Simulate random actions from the node until terminal state or max depth. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_adcfd05d490fbdf9c71929ae591e0ab8d}{get\+\_\+best\+\_\+path}} (self)
\begin{DoxyCompactList}\small\item\em Get the path of best-\/visited child nodes from the root. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_a11142d8d66dba17479436e590192fb90}{root}} = root
\item 
\mbox{\hyperlink{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_aab310caec54328f75daa9e0a82fa35c7}{depth}} = depth
\item 
\mbox{\hyperlink{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_a8f4bd2ea226660619b54bd7a3bed820f}{n\+\_\+simulations}} = n\+\_\+simulations
\item 
\mbox{\hyperlink{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_adbbff374479f0397a831fbbd3059dec8}{debug}} = debug
\item 
bool \mbox{\hyperlink{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_a5ac970654c94548d5d9d5c787150b9b7}{debug}} = True
\item 
int \mbox{\hyperlink{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_aed987f22fa5ac170bed5a64a2daa4667}{debug}} = self.\+depth -\/ 1\+:
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Monte Carlo Tree Search algorithm implementation. 

\doxylink{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s}{MCTS} uses random sampling to build a search tree and find optimal action sequences for the container optimization problem. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_af8413689d831e059f7e36002b0375e0b}\index{rl.mcts.mcts.MCTS@{rl.mcts.mcts.MCTS}!\_\_init\_\_@{\_\_init\_\_}}
\index{\_\_init\_\_@{\_\_init\_\_}!rl.mcts.mcts.MCTS@{rl.mcts.mcts.MCTS}}
\doxysubsubsection{\texorpdfstring{\_\_init\_\_()}{\_\_init\_\_()}}
{\footnotesize\ttfamily \label{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_af8413689d831e059f7e36002b0375e0b} 
rl.\+mcts.\+mcts.\+MCTS.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self}{, }\item[{\mbox{\hyperlink{classrl_1_1mcts_1_1mcts__node_1_1_m_c_t_s_node}{MCTSNode}}}]{root}{, }\item[{int }]{depth}{ = {\ttfamily 5}, }\item[{int }]{n\+\_\+simulations}{ = {\ttfamily 300}, }\item[{bool }]{debug}{ = {\ttfamily False}}\end{DoxyParamCaption})}



Initialize \doxylink{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s}{MCTS} algorithm. 


\begin{DoxyParams}{Parameters}
{\em root} & Root node of the search tree \\
\hline
{\em depth} & Maximum search depth \\
\hline
{\em n\+\_\+simulations} & Number of simulations to run \\
\hline
{\em debug} & Enable debug output \\
\hline
\end{DoxyParams}

\begin{DoxyCode}{0}
\DoxyCodeLine{00023\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ root:\ MCTSNode,\ depth:\ int\ =\ 5,\ n\_simulations:\ int\ =\ 300,\ debug:\ bool\ =\ \textcolor{keyword}{False}): }
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}! }}
\DoxyCodeLine{00025\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ @brief\ Initialize\ MCTS\ algorithm }}
\DoxyCodeLine{00026\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ @param\ root\ Root\ node\ of\ the\ search\ tree }}
\DoxyCodeLine{00027\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ @param\ depth\ Maximum\ search\ depth }}
\DoxyCodeLine{00028\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ @param\ n\_simulations\ Number\ of\ simulations\ to\ run }}
\DoxyCodeLine{00029\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ @param\ debug\ Enable\ debug\ output }}
\DoxyCodeLine{00030\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}} }
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ self.root\ =\ root }
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ self.depth\ =\ depth }
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ self.n\_simulations\ =\ n\_simulations }
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ self.debug\ =\ debug }
\DoxyCodeLine{00035\  }

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_adcfd05d490fbdf9c71929ae591e0ab8d}\index{rl.mcts.mcts.MCTS@{rl.mcts.mcts.MCTS}!get\_best\_path@{get\_best\_path}}
\index{get\_best\_path@{get\_best\_path}!rl.mcts.mcts.MCTS@{rl.mcts.mcts.MCTS}}
\doxysubsubsection{\texorpdfstring{get\_best\_path()}{get\_best\_path()}}
{\footnotesize\ttfamily \label{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_adcfd05d490fbdf9c71929ae591e0ab8d} 
rl.\+mcts.\+mcts.\+MCTS.\+get\+\_\+best\+\_\+path (\begin{DoxyParamCaption}\item[{}]{self}{}\end{DoxyParamCaption})}



Get the path of best-\/visited child nodes from the root. 

\begin{DoxyReturn}{Returns}
List of actions representing the best path found 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00170\ \ \ \ \ \textcolor{keyword}{def\ }get\_best\_path(self): }
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}! }}
\DoxyCodeLine{00172\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ @brief\ Get\ the\ path\ of\ best-\/visited\ child\ nodes\ from\ the\ root }}
\DoxyCodeLine{00173\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ @return\ List\ of\ actions\ representing\ the\ best\ path\ found }}
\DoxyCodeLine{00174\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}} }
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ path\ =\ [] }
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ node\ =\ self.root }
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ \textcolor{keyword}{True}: }
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ best\_child\ =\ node.best\_child(exploration\_weight=0) }
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ best\_child\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break} }
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ path.append(best\_child.action) }
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ node\ =\ best\_child }
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ path}

\end{DoxyCode}
\Hypertarget{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_abf0f1615b5957012620acadb53e31562}\index{rl.mcts.mcts.MCTS@{rl.mcts.mcts.MCTS}!rollout@{rollout}}
\index{rollout@{rollout}!rl.mcts.mcts.MCTS@{rl.mcts.mcts.MCTS}}
\doxysubsubsection{\texorpdfstring{rollout()}{rollout()}}
{\footnotesize\ttfamily \label{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_abf0f1615b5957012620acadb53e31562} 
rl.\+mcts.\+mcts.\+MCTS.\+rollout (\begin{DoxyParamCaption}\item[{}]{self}{, }\item[{}]{node}{}\end{DoxyParamCaption})}



Simulate random actions from the node until terminal state or max depth. 


\begin{DoxyParams}{Parameters}
{\em node} & Starting node for rollout simulation \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Reward value from the rollout 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00120\ \ \ \ \ \textcolor{keyword}{def\ }rollout(self,\ node): }
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}! }}
\DoxyCodeLine{00122\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ @brief\ Simulate\ random\ actions\ from\ the\ node\ until\ terminal\ state\ or\ max\ depth }}
\DoxyCodeLine{00123\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ @param\ node\ Starting\ node\ for\ rollout\ simulation }}
\DoxyCodeLine{00124\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ @return\ Reward\ value\ from\ the\ rollout }}
\DoxyCodeLine{00125\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}} }
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ state:\ ProblemState\ =\ node.state.copy() }
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ depth\ =\ node.depth\ \ \textcolor{comment}{\#\ Start\ from\ the\ node's\ current\ depth }}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#print(f"{}DEBUG\ -\/\ Starting\ rollout\ from\ depth\ \{depth\}"{}) }}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ rollout\_actions\ =\ [] }
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ \textcolor{keywordflow}{not}\ state.is\_terminal()\ \textcolor{keywordflow}{and}\ depth\ <\ self.depth: }
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Get\ possible\ actions\ as\ (action\_name,\ params)\ tuples }}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ possible\_actions\ =\ state.get\_possible\_actions() }
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ possible\_actions: }
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ debuglog(f\textcolor{stringliteral}{"{}DEBUG\ -\/\ No\ possible\ actions\ at\ depth\ \{depth\}"{}}) }
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break} }
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Choose\ a\ random\ action }}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ action\_name,\ params\ =\ random.choice(possible\_actions) }
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Apply\ the\ action }}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#print(f"{}DEBUG\ -\/\ Rollout\ action:\ \{action\_name\}\ with\ params\ \{params\}"{}) }}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ rollout\_actions.append((action\_name,\ params)) }
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Apply\ action\ to\ state }}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ state.apply\_action(action\_name,\ params) }
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ depth\ +=\ 1 }
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.debug: }
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}DEBUG\ -\/\ Rollout\ completed\ with\ \{len(rollout\_actions)\}\ actions"{}}) }
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}DEBUG\ -\/\ Final\ rollout\ actions:\ \{rollout\_actions[:5]\}\{'...'\ if\ len(rollout\_actions)\ >\ 5\ else\ ''\}"{}}) }
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Calculate\ reward\ based\ on\ final\ state }}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ reward\ =\ state.evaluate(depth) }
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.debug: }
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}DEBUG\ -\/\ Rollout\ ended\ at\ depth\ \{depth\},\ final\ reward:\ \{reward\}"{}}) }
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Output\ all\ subgoals\ and\ their\ fulfillment }}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.belugas\_unloaded }}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.belugas\_finished }}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ self.production\_lines\_finished }}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}DEBUG\ -\/\ Subgoals:\ \{state.belugas\_unloaded\}\ unloaded,\ \{state.belugas\_finished\}\ finished,\ \{state.production\_lines\_finished\}\ production\ lines\ finished"{}}) }
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ After\ rollout: }}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ state.is\_terminal()\ \textcolor{keywordflow}{and}\ self.debug: }
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Terminal\ state\ reached\ in\ rollout!"{}}) }
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ reward }
\DoxyCodeLine{00169\  }

\end{DoxyCode}
\Hypertarget{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_a156ee61d7a35a8cab7ec32494dea1b2a}\index{rl.mcts.mcts.MCTS@{rl.mcts.mcts.MCTS}!search@{search}}
\index{search@{search}!rl.mcts.mcts.MCTS@{rl.mcts.mcts.MCTS}}
\doxysubsubsection{\texorpdfstring{search()}{search()}}
{\footnotesize\ttfamily \label{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_a156ee61d7a35a8cab7ec32494dea1b2a} 
rl.\+mcts.\+mcts.\+MCTS.\+search (\begin{DoxyParamCaption}\item[{}]{self}{}\end{DoxyParamCaption})}



Run the \doxylink{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s}{MCTS} search algorithm. 

\begin{DoxyReturn}{Returns}
Best child node found after all simulations 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keyword}{def\ }search(self): }
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}! }}
\DoxyCodeLine{00038\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ @brief\ Run\ the\ MCTS\ search\ algorithm }}
\DoxyCodeLine{00039\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ @return\ Best\ child\ node\ found\ after\ all\ simulations }}
\DoxyCodeLine{00040\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}} }
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ terminal\_node\_found\ =\ \textcolor{keyword}{False} }
\DoxyCodeLine{00042\  }
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(self.n\_simulations): }
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.debug: }
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}\(\backslash\)nIteration\ \{i+1\}/\{self.n\_simulations\}"{}}) }
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 1.\ Selection }}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \ \ \ node\ =\ self.select(self.root) }
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.debug: }
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}Selected\ node:\ depth=\{node.depth\},\ action=\{node.action\}"{}}) }
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 2.\ Expansion }}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ node.is\_terminal(): }
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ untried\_actions\ =\ node.get\_untried\_action() }
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ untried\_actions: }
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ action\ =\ random.choice(untried\_actions) }
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.debug: }
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}Expanding\ node\ with\ action:\ \{action\}"{}}) }
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ node\ =\ node.expand(action) }
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ node.state.is\_terminal(): }
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.debug: }
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Terminal\ state\ reached!\ Solution\ found."{}}) }
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ terminal\_node\_found\ =\ \textcolor{keyword}{True} }
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Reward\ is\ already\ set\ by\ evaluate() }}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reward\ =\ node.state.evaluate(node.depth) }
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ node.backpropagate(reward) }
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.debug: }
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}Rollout\ reward:\ \{reward\}"{}}) }
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}\ \ \textcolor{comment}{\#\ Abort\ MCTS }}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Abort\ if\ no\ untried\ actions\ are\ available }}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ node.children\ \textcolor{keywordflow}{or}\ node.depth\ >=\ self.depth\ -\/\ 1: }
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.debug: }
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}No\ further\ actions\ possible\ at\ depth\ \{node.depth\}.\ Aborting\ MCTS."{}}) }
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Final\ selection\ as\ at\ the\ end\ of\ the\ method }}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ debuglog(\textcolor{stringliteral}{"{}\(\backslash\)nFinal\ selection\ (early):"{}}) }
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ best\_child\ =\ self.root.best\_child(exploration\_weight=0) }
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ best\_child }
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.debug: }
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}No\ untried\ actions\ available,\ skipping\ expansion."{}}) }
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 3.\ Simulation }}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ reward\ =\ self.rollout(node) }
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.debug: }
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}Rollout\ reward:\ \{reward\}"{}}) }
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \  }
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 4.\ Backpropagation }}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ node.backpropagate(reward) }
\DoxyCodeLine{00092\ \ \ \ \  }
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Final\ selection\ -\/\ always\ the\ same,\ regardless\ of\ how\ we\ got\ here }}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ debuglog(\textcolor{stringliteral}{"{}\(\backslash\)nFinal\ selection:"{}}) }
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ best\_child\ =\ self.root.best\_child(exploration\_weight=0) }
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ best\_child\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \ \ \ \ debuglog(\textcolor{stringliteral}{"{}WARNING:\ Root\ has\ no\ children!"{}}) }
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keywordtype}{None} }
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}: }
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \ \ debuglog(f\textcolor{stringliteral}{"{}Best\ child:\ action=\{best\_child.action\},\ visits=\{best\_child.visits\},\ reward=\{best\_child.total\_reward/best\_child.visits\ if\ best\_child.visits\ >\ 0\ else\ 0\}"{}}) }
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ terminal\_node\_found: }
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ debuglog(\textcolor{stringliteral}{"{}Note:\ A\ terminal\ state\ was\ found!"{}}) }
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ best\_child }
\DoxyCodeLine{00104\  }

\end{DoxyCode}
\Hypertarget{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_af0c0d8b6cb7e0d0bc83d009fa6a6ebc3}\index{rl.mcts.mcts.MCTS@{rl.mcts.mcts.MCTS}!select@{select}}
\index{select@{select}!rl.mcts.mcts.MCTS@{rl.mcts.mcts.MCTS}}
\doxysubsubsection{\texorpdfstring{select()}{select()}}
{\footnotesize\ttfamily \label{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_af0c0d8b6cb7e0d0bc83d009fa6a6ebc3} 
rl.\+mcts.\+mcts.\+MCTS.\+select (\begin{DoxyParamCaption}\item[{}]{self}{, }\item[{}]{node}{}\end{DoxyParamCaption})}



Traverse the tree until we find a not fully expanded node or terminal node. 


\begin{DoxyParams}{Parameters}
{\em node} & Starting node for selection \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Selected node for expansion 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{keyword}{def\ }select(self,\ node): }
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}! }}
\DoxyCodeLine{00107\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ @brief\ Traverse\ the\ tree\ until\ we\ find\ a\ not\ fully\ expanded\ node\ or\ terminal\ node }}
\DoxyCodeLine{00108\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ @param\ node\ Starting\ node\ for\ selection }}
\DoxyCodeLine{00109\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ @return\ Selected\ node\ for\ expansion }}
\DoxyCodeLine{00110\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}} }
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ current\_depth\ =\ 0 }
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ \textcolor{keywordflow}{not}\ node.is\_terminal()\ \textcolor{keywordflow}{and}\ node.is\_fully\_expanded()\ \textcolor{keywordflow}{and}\ current\_depth\ <\ self.depth: }
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ next\_node\ =\ node.best\_child() }
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ next\_node\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}: }
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}\ \ \textcolor{comment}{\#\ If\ no\ children\ are\ present }}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \ \ \ \ node\ =\ next\_node }
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ \ \ current\_depth\ +=\ 1 }
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ node }
\DoxyCodeLine{00119\  }

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\Hypertarget{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_adbbff374479f0397a831fbbd3059dec8}\index{rl.mcts.mcts.MCTS@{rl.mcts.mcts.MCTS}!debug@{debug}}
\index{debug@{debug}!rl.mcts.mcts.MCTS@{rl.mcts.mcts.MCTS}}
\doxysubsubsection{\texorpdfstring{debug}{debug}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily \label{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_adbbff374479f0397a831fbbd3059dec8} 
rl.\+mcts.\+mcts.\+MCTS.\+debug = debug}

\Hypertarget{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_a5ac970654c94548d5d9d5c787150b9b7}\index{rl.mcts.mcts.MCTS@{rl.mcts.mcts.MCTS}!debug@{debug}}
\index{debug@{debug}!rl.mcts.mcts.MCTS@{rl.mcts.mcts.MCTS}}
\doxysubsubsection{\texorpdfstring{debug}{debug}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily \label{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_a5ac970654c94548d5d9d5c787150b9b7} 
bool rl.\+mcts.\+mcts.\+MCTS.\+debug = True}

\Hypertarget{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_aed987f22fa5ac170bed5a64a2daa4667}\index{rl.mcts.mcts.MCTS@{rl.mcts.mcts.MCTS}!debug@{debug}}
\index{debug@{debug}!rl.mcts.mcts.MCTS@{rl.mcts.mcts.MCTS}}
\doxysubsubsection{\texorpdfstring{debug}{debug}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily \label{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_aed987f22fa5ac170bed5a64a2daa4667} 
int rl.\+mcts.\+mcts.\+MCTS.\+debug = self.\+depth -\/ 1\+:}

\Hypertarget{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_aab310caec54328f75daa9e0a82fa35c7}\index{rl.mcts.mcts.MCTS@{rl.mcts.mcts.MCTS}!depth@{depth}}
\index{depth@{depth}!rl.mcts.mcts.MCTS@{rl.mcts.mcts.MCTS}}
\doxysubsubsection{\texorpdfstring{depth}{depth}}
{\footnotesize\ttfamily \label{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_aab310caec54328f75daa9e0a82fa35c7} 
rl.\+mcts.\+mcts.\+MCTS.\+depth = depth}

\Hypertarget{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_a8f4bd2ea226660619b54bd7a3bed820f}\index{rl.mcts.mcts.MCTS@{rl.mcts.mcts.MCTS}!n\_simulations@{n\_simulations}}
\index{n\_simulations@{n\_simulations}!rl.mcts.mcts.MCTS@{rl.mcts.mcts.MCTS}}
\doxysubsubsection{\texorpdfstring{n\_simulations}{n\_simulations}}
{\footnotesize\ttfamily \label{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_a8f4bd2ea226660619b54bd7a3bed820f} 
rl.\+mcts.\+mcts.\+MCTS.\+n\+\_\+simulations = n\+\_\+simulations}

\Hypertarget{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_a11142d8d66dba17479436e590192fb90}\index{rl.mcts.mcts.MCTS@{rl.mcts.mcts.MCTS}!root@{root}}
\index{root@{root}!rl.mcts.mcts.MCTS@{rl.mcts.mcts.MCTS}}
\doxysubsubsection{\texorpdfstring{root}{root}}
{\footnotesize\ttfamily \label{classrl_1_1mcts_1_1mcts_1_1_m_c_t_s_a11142d8d66dba17479436e590192fb90} 
rl.\+mcts.\+mcts.\+MCTS.\+root = root}



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
rl/mcts/mcts.\+py\end{DoxyCompactItemize}
